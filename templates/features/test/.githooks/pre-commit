#!/bin/bash

# Pre-commit hook to check compilation and run tests

echo "ğŸ” Running pre-commit checks..."

# Check if files compile
echo "ğŸ“¦ Checking compilation..."
if ! lamdera make src/Backend.elm src/Frontend.elm; then
    echo "âŒ Compilation failed! Please fix errors before committing."
    exit 1
fi

echo "âœ… Compilation successful!"

# Run tests
echo "ğŸ§ª Running tests..."
if ! elm-test-rs --compiler /opt/homebrew/bin/lamdera tests/Tests.elm; then
    echo "âŒ Tests failed! Please fix failing tests before committing."
    exit 1
fi

echo "âœ… All tests passed!"
echo "ğŸ‰ Pre-commit checks passed. Proceeding with commit..."

exit 0